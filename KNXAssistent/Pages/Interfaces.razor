@page "/interfaces"
@using KNXAssistent.Components
@using KNXManager.Models
@using KNXManager.BusConnection
@inject IBusCommunicator busCommunicator

        <ActiveInterface ActiveInt="@busCommunicator.ActiveInterface"></ActiveInterface>
        <MatListDivider></MatListDivider>
        <InterfacesList KnxInterfaceList="@GetInterfacesList()" OnActiveIntChoose="@UpdatesComponents"></InterfacesList>

    @code {


        List<KnxInterface> knxInterfaces;

        private List<KnxInterface> GetInterfacesList()
        {
            knxInterfaces = new();
            if (busCommunicator.Interfaces.Length != 0)
            {
                foreach (var item in busCommunicator.Interfaces)
                {
                    if (item.IpAddress.ToString() != busCommunicator.ActiveInterface.Ip)
                    {
                        knxInterfaces.Add(
                            new KnxInterface
                            {
                                Ip = item.IpAddress.ToString(),
                                Name = item.FriendlyName,
                                Connected = busCommunicator.CheckConnection(item.IpAddress.ToString()),
                                Mac = item.MacAddress.ToString(),
                                IndividualAddress = item.IndividualAddress,
                            }
                        );
                    }

                }
            }
            return knxInterfaces;
        }
        private void UpdatesComponents()
        {
            StateHasChanged();
        }

    }
