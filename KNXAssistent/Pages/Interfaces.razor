

@page "/Interfaces"
@using KNXManager.BusConnection
@using DAL.Models
@using KNXAssistent.Components
@inject IBusCommunicator busCommunicator

    <FullInterfacesList Interfaces="@GetInterfacesList()"></FullInterfacesList>

    @code {

        List<KnxInterface> knxInterfaces;

        private List<KnxInterface> GetInterfacesList()
        {
            knxInterfaces = new();
            if (busCommunicator.Interfaces.Length != 0)
            {
                foreach (var item in busCommunicator.Interfaces)
                {
                    if (item.IpAddress.ToString() != busCommunicator.ActiveInt.Ip)
                    {
                        knxInterfaces.Add(
                            new KnxInterface
                            {
                                Ip = item.IpAddress.ToString(),
                                Name = item.FriendlyName,
                                Connected = busCommunicator.CheckConnection(item.IpAddress.ToString()),
                                Mac = item.MacAddress.ToString(),
                                IndividualAddress = item.IndividualAddress,
                            }
                        );
                    }

                }
            }
            return knxInterfaces;
        }
        private void UpdatesComponents()
        {
            StateHasChanged();
        }

    }
